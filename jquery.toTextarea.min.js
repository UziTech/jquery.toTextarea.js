!function(e,t,a,i){var n=function(e,i){var n=null;if(void 0!==a.body.createTextRange)n=a.body.createTextRange(),n.moveToPoint(e,i),n.select(),n=t.getSelection().getRangeAt(0);else if(void 0!==a.createRange)if(a.caretPositionFromPoint){var r=a.caretPositionFromPoint(e,i);n=a.createRange(),n.setStart(r.offsetNode,r.offset),n.collapse(!0)}else a.caretRangeFromPoint&&(n=a.caretRangeFromPoint(e,i));return n},r=function(e){for(var t=e.length-1;t>=0;t--)if(e[t].childNodes.length>0){var a=r(e[t].childNodes);if(null!==a)return a}else if(""!==e[t].data)return e[t];return null},l=function(i,l,o){if("string"==typeof i){var s=t.getSelection(),d=i.substring(i.length-1),c=e(this).text(),f=a.createTextNode("\n");""!==c&&(lastChar=c.substring(c.length-1),lastNode=r(this.childNodes));var h="\n"===d&&"\n"!==lastChar&&(null===lastChar||s.anchorNode===lastNode&&s.anchorOffset===lastNode.length||s.focusNode===lastNode&&s.focusOffset===lastNode.length),g=a.createTextNode(i),u=null;u=void 0!==l&&void 0!==o?n(l,o):s.getRangeAt(0),u.deleteContents(),h&&u.insertNode(f),u.insertNode(g),u=a.createRange(),u.setStartAfter(g),u.collapse(!0),s.removeAllRanges(),s.addRange(u),this.normalize()}},o=function(a,i,r){var l=e(this),o=new FileReader;o.onload=function(e){var a=new Image;a.onload=function(){var e=t.getSelection(),a=n(i,r);null!==a?(a.insertNode(this),a.collapse(!1),e.removeAllRanges(),e.addRange(a)):l.is(":focus")?(a=e.getRangeAt(0),a.collapse(!1),a.insertNode(this),a.collapse(!1),e.removeAllRanges(),e.addRange(a)):l.append(this)},a.onerror=function(){alert("Not an image")},a.src=e.target.result},o.readAsDataURL(a)},s=function(){if(a.body.createTextRange){var e=a.body.createTextRange();e.moveToElementText(this),e.select()}else if(t.getSelection){var i=t.getSelection(),e=a.createRange();e.selectNodeContents(this),i.removeAllRanges(),i.addRange(e)}};e.fn.toTextarea=function(a){if("destroy"===a||!0===a)return this.each(function(){var t=e(this);t.data().isTextarea&&(this.id&&e("label[for='"+this.id+"']").off(".toTextarea"),t.prop({contentEditable:!1}).off(".toTextarea").data({isTextarea:!1}).removeClass("toTextarea-disabled toTextarea-placeholder toTextarea"))});if("disable"===a)return this.each(function(){var t=e(this);t.data().isTextarea&&!t.data().disabled&&(this.id&&e("label[for='"+this.id+"']").off(".toTextarea"),t.prop({contentEditable:!1}).data({disabled:!0}).addClass("toTextarea-disabled"))});if("enable"===a)return this.each(function(){var t=e(this);t.data().isTextarea&&t.data().disabled&&(this.id&&e("label[for='"+this.id+"']").on("click.toTextarea",function(){t.focus()}),t.prop({contentEditable:!0}).data({disabled:!1}).removeClass("toTextarea-disabled"))});var i={allowHTML:!1,allowImg:!1,singleLine:!1,pastePlainText:!0,placeholder:!1};return e.isPlainObject(a)&&e.extend(i,a),this.each(function(){var a=e(this);if(!a.data().isTextarea&&1){this.id&&e("label[for='"+this.id+"']").on("click.toTextarea",function(){a.focus()});var n=i.allowHTML;"function"==typeof i.allowHTML&&(n=i.allowHTML.call(this));var r=i.allowImg;"function"==typeof i.allowImg&&(r=i.allowImg.call(this));var d=i.singleLine;"function"==typeof i.singleLine&&(d=i.singleLine.call(this));var c=i.pastePlainText;"function"==typeof i.pastePlainText&&(c=i.pastePlainText.call(this));var f=i.placeholder;"function"==typeof i.placeholder&&(f=i.placeholder.call(this)),f||(f=a.attr("placeholder")||a.data().placeholder),a.addClass("toTextarea").prop({contentEditable:!0}).data({isTextarea:!0,disabled:!1}).on("select.toTextarea",function(){e(this).data().disabled||s.call(this)}).on("keypress.toTextarea keyup.toTextarea",function(){e(this).trigger("input")}),f&&a.attr({"data-placeholder":f}).addClass("toTextarea-placeholder"),d?(a.addClass("toTextarea-singleLine").on("keypress.toTextarea",function(t){if(!e(this).data().disabled&&13===t.which)return t.preventDefault(),!1}),a.on("paste.toTextarea",function(a){if(!e(this).data().disabled){var i=null;if(t.clipboardData)i=t.clipboardData.getData("Text");else{if(!a.originalEvent.clipboardData)return!0;i=a.originalEvent.clipboardData.getData("text/plain")}return i=i.replace(/[\n]/g," "),l.call(this,i),a.preventDefault(),e(this).trigger("input"),!1}}).on("drop.toTextarea",function(t){if(!e(this).data().disabled){var a=null;return a=t.originalEvent.dataTransfer.getData("text"),a=a.replace(/[\n]/g," "),l.call(this,a,t.originalEvent.clientX,t.originalEvent.clientY),t.preventDefault(),e(this).trigger("input"),!1}})):(a.on("keypress.toTextarea",function(t){if(!e(this).data().disabled&&13===t.which)return l.call(this,"\n"),t.preventDefault(),!1}),n&&!c||a.on("paste.toTextarea",function(a){if(!e(this).data().disabled){var i=null;if(t.clipboardData)i=t.clipboardData.getData("Text");else{if(!a.originalEvent.clipboardData)return!0;i=a.originalEvent.clipboardData.getData("text/plain")}return l.call(this,i),a.preventDefault(),e(this).trigger("input"),!1}}).on("drop.toTextarea",function(t){if(!e(this).data().disabled){var a=null;return a=t.originalEvent.dataTransfer.getData("text"),l.call(this,a,t.originalEvent.clientX,t.originalEvent.clientY),t.preventDefault(),e(this).trigger("input"),!1}})),r&&a.on("drop.toTextarea",function(t){if(!e(this).data().disabled&&t.originalEvent.dataTransfer.files.length>0){for(var a=0,i=t.originalEvent.dataTransfer.files.length;a<i;a++)o.call(this,t.originalEvent.dataTransfer.files[a],t.originalEvent.clientX,t.originalEvent.clientY);return t.preventDefault(),e(this).trigger("input"),!1}}).on("dragover.toTextarea",function(t){if(!e(this).data().disabled&&t.originalEvent.dataTransfer.types.length>0&&"Files"===t.originalEvent.dataTransfer.types[0])return t.preventDefault(),!1}),n||a.on("keydown.toTextarea",function(t){if(!e(this).data().disabled&&t.ctrlKey&&(66===t.which||73===t.which||75===t.which||85===t.which))return t.preventDefault(),!1})}})},e(function(){var t=e("<style class='toTextarea-stylesheet'> .toTextarea { text-align: left; border: 1px solid #aaa; white-space: pre-wrap; word-wrap: break-word; padding: 1px; } .toTextarea-singleLine { white-space: pre; } .toTextarea-disabled { background-color: #eee; color: #555; } .toTextarea-placeholder:empty:after { color: #555; font-style: italic; cursor: text; content: attr(data-placeholder); }</style>"),a=e("head link[rel='stylesheet'], head style");a.length>0?a.eq(0).before(t):e("head").append(t)})}(jQuery,window,document);