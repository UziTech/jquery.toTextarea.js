(function(c,l,f,m){function u(a,k,e){var h=c(this),f=new FileReader;f.onload=function(a){var d=new Image;d.onload=function(){var d=l.getSelection(),a=r(k,e);null!==a?(a.insertNode(this),a.collapse(!1),d.removeAllRanges(),d.addRange(a)):h.is(":focus")?(a=d.getRangeAt(0),a.collapse(!1),a.insertNode(this),a.collapse(!1),d.removeAllRanges(),d.addRange(a)):h.append(this)};d.onerror=function(){alert("Not an image")};d.src=a.target.result};f.readAsDataURL(a)}function p(a,k,e){var h=l.getSelection(),b=a.substring(a.length-
1),g=c(this).text(),d=f.createTextNode("\n"),q=null,n=null;""!==g&&(q=g.substring(g.length-1),n=t(this.childNodes));b="\n"===b&&"\n"!==q&&(null===q||h.anchorNode===n&&h.anchorOffset===n.length||h.focusNode===n&&h.focusOffset===n.length);a=f.createTextNode(a);g=null;g=k!==m&&e!==m?r(k,e):h.getRangeAt(0);g.deleteContents();b&&g.insertNode(d);g.insertNode(a);g=f.createRange();g.setStartAfter(a);g.collapse(!0);h.removeAllRanges();h.addRange(g)}function t(a){for(var k=a.length-1;0<=k;k--)if(0<a[k].childNodes.length){var c=
t(a[k].childNodes);if(null!==c)return c}else if(""!==a[k].data)return a[k];return null}function r(a,c){var e=null;if(f.body.createTextRange!==m)e=f.body.createTextRange(),e.moveToPoint(a,c),e.select(),e=l.getSelection().getRangeAt(0);else if(f.createRange!==m)if(f.caretPositionFromPoint){var b=f.caretPositionFromPoint(a,c),e=f.createRange();e.setStart(b.offsetNode,b.offset);e.collapse(!0)}else f.k&&(e=f.k(a,c));return e}var b={d:!1,e:!1,i:!1,g:!0};c.m.p=function(a){if("destroy"===a||!0===a)return this.l(function(){delete this.value;
c(this).f({border:"","white-space":"",padding:""}).h({contentEditable:!1}).o(".toTextarea").data({j:!1})});if("disable"===a)return this.f({"background-color":"#eee",color:"#555"}).h({contentEditable:!1}).data({disabled:!0});if("enable"===a)return this.f({"background-color":"",color:""}).h({contentEditable:!0}).data({disabled:!1});c.n(a)&&c.extend(b,a);return this.l(function(){var a=c(this);if(!a.data().j){var e=b.d;"function"===typeof b.d&&(e=b.d.call(this));var h=b.e;"function"===typeof b.e&&(h=
b.e.call(this));var m=b.i;"function"===typeof b.i&&(m=b.i.call(this));var g=b.g;"function"===typeof b.g&&(g=b.g.call(this));a.f({border:"1px solid #aaa","white-space":m?"pre":"pre-wrap","word-wrap":"break-word",padding:"1px"}).h({contentEditable:!0}).data({j:!0,disabled:!1}).b("select.toTextarea",function(){if(!c(this).data().disabled)if(f.body.createTextRange){var d=f.body.createTextRange();d.moveToElementText(this);d.select()}else if(l.getSelection){var a=l.getSelection(),d=f.createRange();d.selectNodeContents(this);
a.removeAllRanges();a.addRange(d)}});m?(a.b("keypress.toTextarea",function(d){if(!c(this).data().disabled&&13===d.which)return d.preventDefault(),!1}),a.b("paste.toTextarea",function(d){if(!c(this).data().disabled){var a=null;if(l.clipboardData)a=l.clipboardData.getData("Text");else if(d.a.clipboardData)a=d.a.clipboardData.getData("text/plain");else return!0;a=a.replace(/[\n]/g," ");p.call(this,a);d.preventDefault();c(this).c("input");return!1}}).b("drop.toTextarea",function(d){if(!c(this).data().disabled){var a=
null,a=d.a.dataTransfer.getData("text/plain"),a=a.replace(/[\n]/g," ");p.call(this,a,d.a.clientX,d.a.clientY);d.preventDefault();c(this).c("input");return!1}})):(a.b("keypress.toTextarea",function(a){if(!c(this).data().disabled&&13===a.which)return p.call(this,"\n"),a.preventDefault(),!1}),e&&!g||a.b("paste.toTextarea",function(a){if(!c(this).data().disabled){var b=null;if(l.clipboardData)b=l.clipboardData.getData("Text");else if(a.a.clipboardData)b=a.a.clipboardData.getData("text/plain");else return!0;
p.call(this,b);a.preventDefault();c(this).c("input");return!1}}).b("drop.toTextarea",function(a){if(!c(this).data().disabled){var b=null,b=a.a.dataTransfer.getData("text/plain");p.call(this,b,a.a.clientX,a.a.clientY);a.preventDefault();c(this).c("input");return!1}}));h&&a.b("drop.toTextarea",function(a){if(!c(this).data().disabled&&0<a.a.dataTransfer.files.length){for(var b=0,e=a.a.dataTransfer.files.length;b<e;b++)u.call(this,a.a.dataTransfer.files[b],a.a.clientX,a.a.clientY);a.preventDefault();
c(this).c("input");return!1}}).b("dragover.toTextarea",function(a){if(!c(this).data().disabled&&0<a.a.dataTransfer.types.length&&"Files"===a.a.dataTransfer.types[0])return a.preventDefault(),!1});e||a.b("keydown.toTextarea",function(a){if(!c(this).data().disabled&&a.ctrlKey&&a.which in{66:1,73:1})return a.preventDefault(),!1})}})}})(jQuery,window,document);